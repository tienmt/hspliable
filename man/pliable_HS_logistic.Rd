% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gibbs.R
\name{pliable_HS_logistic}
\alias{pliable_HS_logistic}
\title{Gibbs sampler for Logistic pliable Horseshoe with (Group) Horseshoe Prior for sparse interaction effects.}
\usage{
pliable_HS_logistic(
  y,
  X,
  Z,
  n_iter = 2000L,
  burn_in = 1000L,
  sigma0_sq = 1,
  eps = 1e-06,
  clamp_min = 1e-10,
  clamp_max = 1e+10,
  verbose = TRUE
)
}
\arguments{
\item{y}{Numeric vector of binary outcomes of length \eqn{n}.}

\item{X}{Numeric matrix of predictors of dimension \eqn{n \times p}.}

\item{Z}{Numeric matrix of modifying variables of dimension \eqn{n \times q}.
Must have the same number of rows as \code{X}.}

\item{n_iter}{Integer. Total number of Gibbs iterations. Default is 2000.}

\item{burn_in}{Integer. Number of burn-in iterations discarded from the
beginning of the chain. Default is 1000.}

\item{sigma0_sq}{Prior variance for the intercept block (scalar). Default is 1.0.}

\item{eps}{Small ridge term added for numerical stability in matrix inversions.
Default is 1e-6.}

\item{clamp_min}{Minimum allowed value for local/global shrinkage parameters
(\eqn{\lambda^2}, \eqn{\tau^2}). Default is 1e-10.}

\item{clamp_max}{Maximum allowed value for local/global shrinkage parameters.
Default is 1e10.}

\item{verbose}{Logical. If \code{TRUE}, prints progress every 500 iterations.}
}
\value{
A list with the following elements:
\item{beta0}{Posterior samples of the intercept \eqn{\beta_0}.}
\item{theta0}{Posterior samples of the intercept modifier vector \eqn{\theta_0}.}
\item{beta}{Posterior samples of main effects \eqn{\beta_j}, dimension \eqn{(n_{\text{save}} \times p)}.}
\item{theta}{Posterior samples of modifier effects \eqn{\theta_j}, stored as an array with dimensions \eqn{(n_{\text{save}}, p, q)}.}
\item{tau2}{Posterior samples of the global scale parameter \eqn{\tau^2}.}
\item{lambda2}{Posterior samples of local scale parameters \eqn{\lambda_j^2}, dimension \eqn{(n_{\text{save}} \times p)}.}
\item{config}{List of configuration parameters used in the run.}
}
\description{
This function implements a Gibbs sampler for logistic regression with
pliable lasso structure and a group horseshoe prior.
It is written in Rcpp and uses \pkg{RcppArmadillo} for efficiency.
The sampler relies on Polya-Gamma data augmentation and requires the
\pkg{BayesLogit} package for random draws from the Polya-Gamma distribution.
}
\details{
The model is
\deqn{ \text{logit}(P(y_i = 1)) = \beta_0 + Z_i \theta_0
      + \sum_{j=1}^p X_{ij} \big( \beta_j + Z_i \theta_j \big), }
where \eqn{\beta_j} are the main effects, \eqn{\theta_j} are modifier
effects associated with modifying variables \eqn{Z}, and the prior on each
group \eqn{(\beta_j, \theta_j)} is the group horseshoe:
\deqn{ (\beta_j, \theta_j) \sim \mathcal{N}\left(0, \tau^2 \lambda_j^2 I\right), }

#' The regression coefficients (\eqn{\beta} for main effects and \eqn{\theta} for modifier interactions)
follow \strong{hierarchical Horseshoe priors}, which allow for strong shrinkage of irrelevant
predictors while leaving relevant predictors relatively unshrunk:

\deqn{\lambda_j^2 \sim \text{Inv-Gamma}(1/2, 1/ \nu_j), \quad \nu_j \sim \text{Inv-Gamma}(1/2, 1),}
\deqn{\tau^2 \sim \text{Inv-Gamma}(1/2, 1/\xi), \quad \xi \sim \text{Inv-Gamma}(1/2, 1).}

Posterior inference is performed via Polya-Gamma data augmentation and
Gibbs sampling, following the algorithm implemented in C++ for speed.
}
\examples{
\dontrun{
set.seed(123)
n <- 100; p <- 5; q <- 2
X <- matrix(rnorm(n*p), n, p)
Z <- matrix(rnorm(n*q), n, q)
beta_true <- rnorm(p)
theta_true <- matrix(rnorm(p*q), p, q)
eta <- 1 + X \%*\% beta_true + rowSums((X \%*\% theta_true) * Z)
prob <- 1/(1+exp(-eta))
y <- rbinom(n, 1, prob)

fit <- pliable_HS_logistic(y, X, Z, n_iter = 2000, burn_in = 1000)
str(fit)
}

}
\references{
\itemize{
\item Polson, N. G., Scott, J. G., & Windle, J. (2013).
Bayesian inference for logistic models using Pólya–Gamma latent variables.
\emph{Journal of the American Statistical Association}, 108(504), 1339–1349.
\item Mai. T.T. (2025). Bayesian Pliable Lasso with Horseshoe Prior for Interaction Effects in GLMs with Missing Responses. arXiv
}
}
\author{
The Tien Mai, \email{the.tien.mai@fhi.no}
}
