% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gibbs.R
\name{pliable_HS}
\alias{pliable_HS}
\title{Gibbs sampler for Pliable Horseshoe for sparse interaction effects with Missing Data}
\usage{
pliable_HS(
  y,
  X,
  Z,
  n_iter = 2000,
  burn_in = 1000,
  a0 = 0.01,
  b0 = 0.01,
  sigma0_sq = 1,
  eps = 1e-06,
  verbose = FALSE,
  seed = NULL
)
}
\arguments{
\item{y}{Numeric vector of responses of n samples;
may contain \code{NA} for missing values.}

\item{X}{Numeric matrix of predictors (n x p).}

\item{Z}{Numeric matrix of modifying covariates (n x q).}

\item{n_iter}{Number of Gibbs iterations (default 2000).}

\item{burn_in}{Number of burn-in iterations (default 1000).}

\item{a0, b0}{Hyperparameters for the inverse-gamma prior on \eqn{\sigma^2} (default 0.01 each).}

\item{sigma0_sq}{Prior variance for the intercept block (\eqn{\beta_0, \theta_0}) (default 1.0).}

\item{eps}{Small ridge term added for numerical stability (default 1e-6).}

\item{verbose}{Logical; if TRUE, prints progress every 500 iterations.}

\item{seed}{Optional random seed for reproducibility.}
}
\value{
A list of posterior samples containing:
\describe{
\item{\code{beta0}}{Vector of posterior samples for the intercept.}
\item{\code{theta0}}{Matrix of posterior samples for modifying covariates in the intercept block (\eqn{\theta_0}).}
\item{\code{beta}}{Matrix of posterior samples for main effects (\eqn{\beta}).}
\item{\code{theta}}{Array of posterior samples for modifying effects of each predictor (\eqn{\theta_j}, dimensions p x q x n_samples).}
\item{\code{sigma2}}{Vector of posterior samples for residual variance.}
\item{\code{tau2}}{Vector of posterior samples for the global shrinkage parameter.}
\item{\code{lambda2}}{Matrix of posterior samples for local shrinkage parameters of each predictor.}
\item{\code{config}}{List of sampler configuration parameters (n_iter, burn_in, a0, b0, sigma0_sq, eps).}
}
}
\description{
This function performs Bayesian inference for the \strong{pliable lasso model}
in the presence of missing response values. The pliable lasso extends
the standard lasso by allowing \strong{coefficients of predictors to vary
as a linear function of modifying covariates} (Z). In other words, the
effect of X on y can be modified by Z:
}
\details{
\deqn{y_i = \beta_0 + Z_i \theta_0 + X_i \beta + \sum_j X_{ij} (Z_i^\top \theta_j) + \epsilon_i, \quad \epsilon_i \sim N(0, \sigma^2)}

where missing entries in y are imputed during the Gibbs sampler.

The regression coefficients (\eqn{\beta} for main effects and \eqn{\theta} for modifier interactions)
follow \strong{hierarchical Horseshoe priors}, which allow for strong shrinkage of irrelevant
predictors while leaving relevant predictors relatively unshrunk:

\deqn{\beta_j, \theta_j \mid \lambda_j, \tau \sim N(0, \tau^2 \lambda_j^2 I),}
\deqn{\lambda_j^2 \sim \text{Inv-Gamma}(1/2, 1/ \nu_j), \quad \nu_j \sim \text{Inv-Gamma}(1/2, 1),}
\deqn{\tau^2 \sim \text{Inv-Gamma}(1/2, 1/\xi), \quad \xi \sim \text{Inv-Gamma}(1/2, 1).}

This hierarchical structure is implemented in C++ using \strong{Rcpp and Armadillo} for efficiency.
}
\examples{
\dontrun{
n <- 100; p <- 5; q <- 2
X <- matrix(rnorm(n * p), n, p)
Z <- matrix(rnorm(n * q), n, q)
beta_true <- rnorm(p)
theta_true <- matrix(rnorm(p * q), p, q)
y <- X \%*\% beta_true + rowSums((Z \%*\% t(theta_true)) * X)

y[sample(n, 10)] <- NA  # introduce missing values

fit <- pliable_HS(y, X, Z, n_iter = 500, burn_in = 200)
}

}
\references{
\itemize{
\item Tibshirani, R., & Friedman, J. (2020). A pliable lasso. \emph{Journal of Computational and Graphical Statistics, 29}(1), 215-225.
\item Mai. T.T. (2025). Bayesian Pliable Lasso with Horseshoe Prior for Interaction Effects in GLMs with Missing Responses. arXiv
}
}
\author{
The Tien Mai, \email{the.tien.mai@fhi.no}
}
